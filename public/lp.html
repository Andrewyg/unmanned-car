<style>
    table,
    td,
    th {
        border: 1px solid #ddd;
        text-align: left;
    }

    table {
        border-collapse: collapse;
        width: 100%;
    }

    th,
    td {
        padding: 15px;
    }
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    Array.prototype.getRand = function () {
        return this[Math.floor(Math.random() * this.length)]
    }
    function randNum(min, max) {
        var r = Math.floor(Math.random() * (max - min + 1)) + min;
        return r;
    }
    var keys = ["bottom", "right", "top", "left"];
    var dirs = ["left", "straight", "right"];
    var wholeHTML = "";
    function getUrlVars() {
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for (var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    }
    var query = getUrlVars();
    var queryFull = window.location.href.slice(window.location.href.indexOf('?') + 1);
    var addCar = new Promise((resolve, reject) => {
        $.post("/api/add", { place: keys.getRand(), direction: dirs.getRand() }, (data) => { }).then(() => resolve())
    })
    var results = [];
    var operate = new Promise((resolce, reject) => {
        $.get('/api/operate/current?' + queryFull, (data) => {
            results.push(data.output);
        }).then(() => resolve())
    })
    async function main() {
        for (j = 0; j < query.dataAmount; j++) {
            for (i = 0; i < query.carAmount; i++) {
                await addCar;
            }
            await operate
        }
        return window.location.replace("/api/clear/scene");
    }
</script>