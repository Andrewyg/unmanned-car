<style>
    table,
    td,
    th {
        border: 1px solid #ddd;
        text-align: left;
    }

    table {
        border-collapse: collapse;
        width: 100%;
    }

    th,
    td {
        padding: 15px;
    }
</style>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
    Array.prototype.getRand = function () {
        return this[Math.floor(Math.random() * this.length)]
    }
    function randNum(min, max) {
        var r = Math.floor(Math.random() * (max - min + 1)) + min;
        return r;
    }
    var keys = ["bottom", "right", "top", "left"];
    var dirs = ["left", "straight", "right"];
    var wholeHTML = "";
    function getUrlVars() {
        var vars = [], hash;
        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for (var i = 0; i < hashes.length; i++) {
            hash = hashes[i].split('=');
            vars.push(hash[0]);
            vars[hash[0]] = hash[1];
        }
        return vars;
    }
    var query = getUrlVars();
    var queryFull = window.location.href.slice(window.location.href.indexOf('?') + 1);
    async function addCar(dest) {
        $.post("/api/add", { place: keys.getRand(), direction: dirs.getRand() }, (data) => {
        }).then(() => {
            if (dest > 0) return addCar(dest - 1); else return;
        })
    }
    var results = [];
    async function operate(dest) {
        await addCar(randNum(query.carMin, query.carMax));
        $.get('/api/operate/current?' + queryFull, (data) => {
            results.push(data.output);
        }).then(() => {
            if (dest > 0) return operate(dest - 1); else return;
        })
    }
    var original = [];
    var compare = [];
    async function getOtherData(dest) {
        await operate(query.dataAmount - 1);
        $.get("/api/db/scene/" + results[dest].refCIns, (data) => {
            original.push(data);
            $.get("/api/db/compare/" + results[dest].refCompare, (data2) => {
                compare.push(data2);
            }).then(() => {
                if (dest < results.length - 1) return getOtherData(dest + 1); else return window.location.replace("/api/clear/scene");
            })
        })
    }
    getOtherData(0)
</script>